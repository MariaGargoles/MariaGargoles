name: Generate Snake Animation

on:
    schedule:
        # Actualiza la animaci√≥n cada 6 horas
        - cron: "0 */6 * * *"
    workflow_dispatch:

permissions:
  contents: write

jobs:
    generate:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
              with:
                  token: ${{ secrets.GITHUB_TOKEN }}
                  fetch-depth: 0

            - uses: Platane/snk@master
              id: snake-gif
              with:
                  github_user_name: mariagargoles
                  svg_out_path: output/github-contribution-grid-snake.svg

            - name: Push to main branch
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              run: |
                  git config --local user.email "segwanda12@gmail.com"
                  git config --local user.name "MariaGargoles"
                  git add output/github-contribution-grid-snake.svg
                  if git diff --staged --quiet; then
                      echo "No changes to commit"
                      exit 0
                  fi
                  git commit -m "Update snake animation" --author="MariaGargoles <segwanda12@gmail.com>"
                  git remote set-url origin https://x-access-token:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}.git
                  git push origin HEAD:main
